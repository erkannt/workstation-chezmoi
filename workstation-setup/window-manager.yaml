- name: Install window manager
  hosts: localhost
  become: true

  tasks:
    - name: dwm build dependencies
      apt:
        name: "{{ item }}"
        state: present
      loop:
        - build-essential
        - libx11-dev
        - libxinerama-dev
        - sharutils

    - name: Get dwm source
      git:
        repo: "https://github.com/erkannt/my-dwm.git"
        version: "main"
        dest: /tmp/dwm

    - name: Install dwm
      make:
        chdir: /tmp/dwm
        target: install

    - name: Get dwm-from-gdm
      git:
        repo: "https://github.com/erkannt/my-dwm-from-gdm.git"
        version: "master"
        dest: /tmp/dwm-from-gdm

    - name: Make dwm accesible from gdm and set launch script
      make:
        chdir: /tmp/dwm-from-gdm
        target: install

    - name: Install related tools
      apt:
        name: "{{ item }}"
        state: present
      loop:
        - rofi
        - feh
